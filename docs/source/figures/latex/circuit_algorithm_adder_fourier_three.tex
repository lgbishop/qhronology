\documentclass{article}
\pagenumbering{gobble}
\input{./../../preamble/header.tex}
\input{./../../preamble/macros.tex}

\usepackage{geometry}
\geometry{
paperwidth=20cm,
paperheight=6cm,
margin=0cm
}

\usepackage{amsmath,amsfonts,amssymb}
\usepackage{bm}
\usepackage{tikz}
\usetikzlibrary{arrows,decorations.markings}
\usetikzlibrary{shapes}
\usetikzlibrary{quantikz}
%\usetikzlibrary{quantikz2}
\begin{document}
\begin{quantikz}[row sep={0.75*\QuantikzSeparationRow cm, between origins}, column sep=0.25cm]%[transparent]
    \lstick{$\ket{x_2}$} &[0.25cm] \qw&\qw&\qw&\qw&\qw&\qw &[0.35 cm]\ctrl{3}\gategroup[6,steps=6,style={thin,rounded corners,fill=none, inner xsep=2pt},background, label style={label position=below,anchor=north,yshift=-0.2cm}]{CPHASE}&\qw&\qw&\qw&\qw&\qw&[0.35 cm]\qw &\qw&\qw&\qw&\qw&\qw&[0.25cm] \qw \rstick{$\ket{x_2}$} \\
    \lstick{$\ket{x_1}$} &\qw&\qw&\qw&\qw&\qw&\qw &\qw&\ctrl{2}&\qw&\ctrl{3}&\qw&\qw&\qw &\qw&\qw&\qw&\qw&\qw& \qw \rstick{$\ket{x_1}$} \\
    \lstick{$\ket{x_0}$} &\qw&\qw&\qw&\qw&\qw&\qw &\qw&\qw&\ctrl{1}&\qw&\ctrl{2}&\ctrl{3}&\qw &\qw&\qw&\qw&\qw&\qw& \qw \rstick{$\ket{x_0}$} \\[0.5*\QuantikzSeparationRow cm]
    \lstick{$\ket{y_2}$} &\gate[disable auto height]{H}\gategroup[3,steps=6,style={thin,rounded corners,fill=none, inner xsep=2pt},background, label style={label position=below,anchor=north,yshift=-0.2cm}]{QFT} &\ctrl{1}&\ctrl{2}&\qw&\qw&\qw &\gate[disable auto height]{Z}&\gate[disable auto height]{S}&\gate[disable auto height]{T}&\qw&\qw&\qw&\qw \gategroup[3,steps=6,style={thin,rounded corners,fill=none, inner xsep=2pt},background, label style={label position=below,anchor=north,yshift=-0.2cm}]{QFT$^{-1}$}&\qw&\qw&\ctrl{2}&\ctrl{1}&\gate[disable auto height]{H}& \qw \rstick{$\ket{s_2}$} \\
    \lstick{$\ket{y_1}$} &\qw&\gate[disable auto height]{S}&\qw&\gate[disable auto height]{H}&\ctrl{1}&\qw &\qw&\qw&\qw&\gate[disable auto height]{Z}&\gate[disable auto height]{S}&\qw&\qw &\ctrl{1}&\gate[disable auto height]{H}&\qw&\gate[disable auto height]{S}&\qw& \qw \rstick{$\ket{s_1}$} \\
    \lstick{$\ket{y_0}$} &\qw&\qw&\gate[disable auto height]{T}&\qw&\gate[disable auto height]{S}&\gate[disable auto height]{H} &\qw&\qw&\qw&\qw&\qw&\gate[disable auto height]{Z}& \gate[disable auto height]{H}&\gate[disable auto height]{S}&\qw&\gate[disable auto height]{T}&\qw&\qw& \qw \rstick{$\ket{s_0}$}
\end{quantikz}
\end{document}
